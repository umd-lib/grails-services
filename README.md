grails-services
===============

Suite of Grails based services.

Documentation
-------------
---

AutoNumber
-------------
Current services are limited to the AutoNumber service. The majority of the code for this service is in the edu.umd.lib.grails.services.RestAutoNumberController and edu.umd.lib.grails.services.AutoNumberController controllers. The RestAutoNumberController is responsible for handling the RESTful web service requests. The AutoNumberController is responsible for the form based autonumber generation and also for the grails generated database manipulation forms. The remaining InitialsController and RepositoryController are grails generated database manipulation controllers (these are auto generated). 

The database is separated into 3 tables with 3 associated domain classes. The edu.umd.lib.grails.services.AutoNumber class is the top-level class it contains references to a edu.umd.lib.grails.services.Initials and a edu.umd.lib.grails.services.Repository. There is nothing particularly special about these classes other than an added index (see constraints in each class) in the Initials and Repository classes. This allows for faster searches.  

There are custom /grails-services/grails-app/conf/UrlMappings.groovy entries for the RESTful web services calls and also for the web based forms. The `grails.mime.use.accept.header = true` option has been turned on to process the accept types. This is used in the RestAutoNumberController to determine the type of response to return (XML/JSON). 

Due to some Grails limitations, I have downloaded and installed JQuery manually. So the `/grails-services/web-app/js` and `/grails-services/web-app/css` contain the JQuery 1.9.1 and JQuery UI 1.10.1 smoothness libraries. There is also a custom javascript `/grails-services/web-app/js/AutoNumberForm.js` used in the auto number form. This script adds to the default JQuery combo box, it adds the ability to auto complete. 

The AutoNumber custom form is here `/grails-services/grails-app/views/autoNumber/create2.gsp` it is an altered clone of the generated grails form. Grails has a bug with the JQuery plugin. If used you can not specify the order of the script imports. JQuery needs to be first, its always last. There is nothing special here, just make sure to notice the 2 lines of embedded JS and the custom CSS in the head element.

**RestAutoNumberController**

Supports 2 real operations a Save and a Show. Both use the Accept header in the client request to determine the response type JSON(Default) or XML. The show method handles search requests.  The save method generates an new filename and updates tables, then returns the generated file name. There are 2 helper methods setRepos and getRepos. These methods update and get repo names stored in the fedorstage. The get method also gets the repo names stored in its repository db table. It combines the two sets of repo names and returns them in ascending order. The fetching and saving of the repo names is done using Springs RestTemplate.

Rest requests have the following syntax 
`/restapi/autonumber/$repository/$initials`

A **Get** request will return a list of search results using the given repository and initials

A **Put** and **Post** request will add a new filename to the autonumber database using the specified repository name and initials. Then returns the newly created filename.


**AutoNumberController**

This controller was generated by grails and the save2 and create2 methods were added to handle the AutoNumberForm. The create2 method is responsible for rendering the initial form the save2 handles a user save. This controller also has a setRepos and getRepos method, which are the duplicates of the ones in the RestAutoNumberController 

**SoapUi**

There is an attached SoapUI project which can be used to test the rest services `/grails-services/grails-services-soapui-project.xml` a download of SoapUI can be found here [http://www.soapui.org/].

[http://www.soapui.org/]:http://www.soapui.org/
    

---
Build Instructions
-------------
To build project execute `mvn -DskipTests clean install` from the project root directory. 

That will create 1 .war (the services code) located here `./target/grails-services-{version}.war`